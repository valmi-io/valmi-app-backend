
{% assign filterStr = "" %}
{% for filter in filters %}    
    {% capture name -%}
        "{{ filter.name }}"
    {%- endcapture -%}
    {% capture value -%}
        '{{ filter.value }}'
    {%- endcapture -%}
    {% assign operator = filter.operator %}
    {% assign filterStr = filterStr| append: name | append: " " | append: operator | append: " "| append: value %}
    {% if forloop.last == false %}
        {% assign filterStr = filterStr| append: " and " %}
    {% endif %}
{% endfor %}
{% if filterStr !="" %}
    {% assign filterStr = filterStr | append: " and " %}
{%  endif  %}

{% if timeWindow.range.start contains "now()" %}
    select * from "{{ schema }}"."{{ table }}" where {{ filterStr }} "updated_at" >= {{ timeWindow.range.start }} and "updated_at" <= {{ timeWindow.range.end }}
{% else %}
    select * from "{{ schema }}"."{{ table }}" where {{ filterStr }} "updated_at" >= '{{ timeWindow.range.start }}' and "updated_at" <= '{{ timeWindow.range.end }}'
{% endif %}
